{% extends "chatRoom/baseLayout.html" %}
{% load static %}
{% block content %}
    <!-- JS for bootstrap -->
    <script src="{% static 'chatRoom/js/bootstrap.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/@joeattardi/emoji-button@3.0.3/dist/index.min.js"></script>
    <!-- Jquery -->
    <script src="{% static 'chatRoom/js/jquery.js' %}"></script>
    <script src="{% static 'chatRoom/js/chatRoom.js' %}"></script>
{% if user.is_authenticated %}
    <!-- Hi {{ user.username }}! -->
    <header>
        <input type="hidden" id="room_id" name="room_id" value="{{ current_room.id }}">
        <input type="hidden" id="user" name="user" value="{{ user.username }}">
        <input type="hidden" id="owner" name="owner" value="{{ owner }}">
        <h1 class="main-page-title"><a href="{% url 'index' %}">Chat Room</a></h1>
        <a class="log-out" href="{% url 'logout' %}" title="DÃ©connexion">Utilisateur : {{ user.username }}</a>
    </header>
    <p class="Room-title">Salons de discussion</p>
    <aside class="Room-list">
        <nav>
            <ul id="Room-list">
                <!-- {% for room in room_list %}
                    {% if room.id == current_room.id %}
                        <li class="current-room"><a>{{ room.name }}</a></li>
                    {% else %}
                        <li class="Room-name"><a href="{% url 'room' room.id %}">{{ room.name }}</a></li>
                    {% endif %}
                {% endfor %} -->
            </ul>
        </nav>
    </aside>
    <button class="show-rooms-button" title="Voir les salons"></button>
    <p class="Messages-title">{{ current_room.name }}</p>
    <section class="messages-list">
        <div id="messages-div">
            <ul class="message-box">
                {% if current_room == NONE %}
                    <p class="message">Rejoingnez un salon pour parler</p>
                {% endif %}
                <!--
                {% for message in current_room.message_set.all %}
                    <li class="user">{{ message.user }}</li>
                    <li class="message">{{ message.message }}</li>
                    <li class="date">{{ message.date }}</li>
                {% endfor %}
                -->
            </ul>
            <br class="space">
        </div>
    </section>
    <section class="fixed-buttons">
        <button class="add-room-button" id="add-room-button" title="Ajouter un salon de discussion"></button>
        {% if current_room.id != NONE %}
            <button class="emoji-button" id="emoji-button" title="Use emojis !"></button>        
            <div>
                <form method="post" id="post-form">
                    {% csrf_token %}
                    <input type="text" placeholder="Votre message..." name="message-text-field" id="msg-txt-field" maxlength="400">
                    <button class="send-button" title="Envoyer le message"> </button>
                </form>
            </div>
            <button class="user-list-button" id="user-list-button" title="Ajouter des utilisateurs dans le salon"></button>
        {% endif %}
    </section>
    <section class="add-room-form">
        <form method="POST" id="add-room-form">
            <h2>Ajout de salon</h2>
            {% csrf_token %}
            <label for="enter-room-name"><p>Nom du salon</p></label>
            <input type="text" name="room-name" id="enter-room-name" placeholder="Nom..." maxlength="50">
            <button type="submit" class="sign-up-button" style="margin-left: 0; margin-right: 20px;">Ajouter le salon</button>
            <button type="button" class="add-room-button" id="cancel-button">Annuler</button>
        </form>
    </section>

    <section class="add-user-form">
        <h2>Utilisateurs dans le salon</h2>
        <div id="user-div">
            <ul class="user-list">
                <!-- {% for users in user_list %}
                    {% if users.username == owner %}
                        <li class="Room-name">{{ users.username }} | Admin</li>
                    {% elif users.username != 'System' %}
                        <li class="Room-name">{{ users.username }}</li>
                    {% endif %}
                {% endfor %} -->
            </ul>
        </div>
        {% if user.username == owner or user.username == System %}
            <div id="add-user-div">
                <form method="POST" id="add-user-form">
                    {% csrf_token %}
                    <input type="search" id="user-add-input" placeholder="Ajouter un utilisateur...">
                    <button type="submit" class="sign-up-button" style="font-size: 15px; margin: 0 0 5px 0;">Ajouter l'utilisateur</button>
                </form>
            </div>
        {% endif %}
    </section>
{% endif %}
{% endblock %}